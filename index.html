<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Premium SIP Calculator (Soft Mint Theme) - Final</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg1: #e9fff4;
      --bg2: #f9fffb;
      --mint1: #00c48c;
      --mint2: #4cd3ad;
      --accent: #019267;
      --card: #ffffff;
      --text: #234341;
    }
    html,body{height:100%; margin:0; font-family: "Poppins", Arial, sans-serif; background: linear-gradient(135deg,var(--bg1),var(--bg2)); color:var(--text); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    .container{max-width:980px; margin:28px auto; padding:20px;}
    .card{background:var(--card); border-radius:16px; padding:26px; box-shadow:0 10px 30px rgba(18,38,30,0.06); border-top:6px solid rgba(0,196,140,0.15); transition:transform .28s ease, box-shadow .28s ease;}
    .card:hover{transform:translateY(-4px); box-shadow:0 18px 40px rgba(18,38,30,0.09);}
    /* Subtle animated header */
    .header{display:flex;align-items:center;gap:16px;margin-bottom:18px; animation:fadeSlide 900ms ease both;}
    .logo{
      width:56px;height:56px;border-radius:12px;
      background:linear-gradient(135deg,var(--mint1),var(--mint2));
      display:flex;align-items:center;justify-content:center; color:white; font-weight:700; font-size:20px; box-shadow:0 6px 18px rgba(76,211,173,0.18);
    }
    h1{font-size:22px;margin:0;color:var(--accent);letter-spacing:0.2px;}
    p.lead{margin:0;color:#486a66;opacity:0.9;}
    @keyframes fadeSlide{
      from{opacity:0; transform:translateY(8px);}
      to{opacity:1; transform:translateY(0);}
    }

    .grid{display:grid;grid-template-columns:1fr 420px; gap:20px;}
    @media (max-width:880px){ .grid{grid-template-columns:1fr; } .right-col{order:-1;} }

    label{display:block;margin-top:12px;font-weight:600;color:#2f4f4f;}
    input,select{width:100%;padding:10px;margin-top:6px;border:1px solid #d8efe2;border-radius:10px;background:#f7fffb;font-size:15px;transition:box-shadow .18s ease, border-color .18s ease;}
    input:focus,select:focus{outline:none;border-color:var(--mint1);box-shadow:0 6px 18px rgba(0,196,140,0.12);}

    .btn-row{display:flex; gap:12px; margin-top:16px;}
    button{flex:1;min-width:120px;padding:12px 16px;border:none;border-radius:10px;cursor:pointer;font-weight:600;color:#fff;background:linear-gradient(90deg,var(--mint1),var(--mint2));box-shadow:0 6px 18px rgba(0,196,140,0.14);transition:transform .16s ease, box-shadow .16s ease; font-size:15px;}
    button.secondary{background:transparent;color:var(--mint1);border:1px solid rgba(0,196,140,0.18);box-shadow:none;}
    button:hover{transform:translateY(-3px);box-shadow:0 10px 28px rgba(0,196,140,0.16);}
    .summary{margin-top:18px;background:linear-gradient(180deg,#f4fff9,#ffffff);padding:14px;border-radius:10px;border-left:4px solid var(--mint1);color:#034f3c;font-weight:600;}

    /* Chart container */
    .chart-card{background:linear-gradient(180deg,#fbfffd,#f6fff9);padding:14px;border-radius:12px;border:1px solid #eaf7ef;box-shadow:inset 0 1px 0 rgba(255,255,255,0.6);}
    canvas{width:100%;height:260px;display:block;border-radius:8px;}

    /* Table styles */
    table{width:100%;border-collapse:collapse;margin-top:22px;border-radius:10px;overflow:hidden;}
    th,td{padding:10px 12px;text-align:center;border-bottom:1px solid #e6f5ec;font-size:14px;}
    th{background:linear-gradient(90deg,var(--mint1),var(--mint2));color:#fff;text-transform:uppercase;font-size:13px;letter-spacing:0.6px;}
    tr:nth-child(even) td{background:#f6fff7;}
    tr:hover td{background:#e9fff0;}

    footer{margin-top:18px;text-align:center;color:#6b8e8e;font-size:13px;}

    /* small responsive tweaks */
    .muted{color:#647e7a;font-size:13px;}
  </style>
</head>
<body>
  <div class="container">
    <div class="card" id="mainCard">
      <div class="header">
        <div class="logo">S</div>
        <div>
          <h1>SIP Calculator</h1>
          <p class="lead muted">with yearly step-up • CSV export table</p>
        </div>
      </div>

      <div class="grid">
        <div class="left-col">
          <label for="monthly">Monthly SIP (₹)</label>
          <input id="monthly" type="number" value="5000">

          <label for="interest">Expected Annual Return (%)</label>
          <input id="interest" type="number" value="12">

          <label for="stepup">Yearly Step-up (%)</label>
          <input id="stepup" type="number" value="5">

          <label for="years">Duration (Years)</label>
          <input id="years" type="number" value="10">

          <label for="startMonth">Start Month</label>
          <select id="startMonth">
            <option value="1">January</option>
            <option value="2">February</option>
            <option value="3">March</option>
            <option value="4">April</option>
            <option value="5">May</option>
            <option value="6">June</option>
            <option value="7">July</option>
            <option value="8">August</option>
            <option value="9">September</option>
            <option value="10">October</option>
            <option value="11">November</option>
            <option value="12">December</option>
          </select>

          <div class="btn-row">
            <button id="calcBtn">Calculate</button>
            <button id="csvBtn" class="secondary">Download CSV</button>
          </div>

          <div id="results" class="summary" aria-live="polite" style="display:none;"></div>
        </div>

        <div class="right-col">
          <div class="chart-card">
            <canvas id="areaChart" width="640" height="260"></canvas>
          </div>

          <div class="muted" style="margin-top:8px;text-align:center;font-size:13px">Animated area chart: corpus growth per year</div>
        </div>
      </div>

      <div id="tableWrap"></div>

      <footer>Designed by vikas for easy calculation</footer>
    </div>
  </div>

<script>
  // Utility & formatting
  const monthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
  function fmt(n){ return Number(n).toLocaleString(undefined,{maximumFractionDigits:2}); }

  // Elements
  const monthlyEl = document.getElementById('monthly');
  const interestEl = document.getElementById('interest');
  const stepupEl = document.getElementById('stepup');
  const yearsEl = document.getElementById('years');
  const startMonthEl = document.getElementById('startMonth');
  const calcBtn = document.getElementById('calcBtn');
  const csvBtn = document.getElementById('csvBtn');
  const resultsEl = document.getElementById('results');
  const tableWrap = document.getElementById('tableWrap');
  const canvas = document.getElementById('areaChart');
  const ctx = canvas.getContext('2d');

  let lastRows = [];

  // Responsive canvas scaling
  function resizeCanvas() {
    const ratio = window.devicePixelRatio || 1;
    const styles = getComputedStyle(canvas);
    const w = canvas.clientWidth;
    const h = parseInt(styles.height);
    canvas.width = Math.floor(w * ratio);
    canvas.height = Math.floor(h * ratio);
    ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
  }
  window.addEventListener('resize', ()=>{ resizeCanvas(); drawPlaceholder(); });
  resizeCanvas();

  // Chart drawing: smooth area chart with animation (no external libs)
  function drawPlaceholder(){
    // light grid placeholder
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const W = canvas.width / (window.devicePixelRatio||1);
    const H = canvas.height / (window.devicePixelRatio||1);
    ctx.save();
    ctx.fillStyle = '#fbfffc';
    ctx.fillRect(0,0,W,H);
    ctx.strokeStyle = 'rgba(4,68,55,0.04)';
    ctx.lineWidth = 1;
    for(let y=0;y<5;y++){
      const yy = 20 + y*(H-40)/4;
      ctx.beginPath(); ctx.moveTo(10,yy); ctx.lineTo(W-10,yy); ctx.stroke();
    }
    ctx.restore();
  }

  function renderAreaChart(years, values){
    resizeCanvas();
    const W = canvas.width / (window.devicePixelRatio||1);
    const H = canvas.height / (window.devicePixelRatio||1);
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // padding
    const pad = {l:40, r:18, t:12, b:28};
    const plotW = W - pad.l - pad.r;
    const plotH = H - pad.t - pad.b;

    // compute scales
    const maxV = Math.max(...values) * 1.08;
    const minV = Math.min(...values, 0);
    const xStep = plotW / Math.max(1, years.length-1);

    // generate points
    const points = values.map((v,i)=>{
      const x = pad.l + i * xStep;
      const y = pad.t + (1 - (v - minV) / (maxV - minV)) * plotH;
      return {x,y,v};
    });

    // animation variables
    const duration = 900; // ms
    const start = performance.now();

    function easeOutCubic(t){ return 1 - Math.pow(1-t,3); }

    function frame(now){
      const t = Math.min(1, (now - start) / duration);
      const eased = easeOutCubic(t);

      // clear
      ctx.clearRect(0,0,W,H);

      // draw grid
      ctx.save();
      ctx.translate(0,0);
      ctx.strokeStyle = 'rgba(4,68,55,0.06)';
      ctx.lineWidth = 1;
      for(let i=0;i<4;i++){
        const yy = pad.t + i*(plotH)/4;
        ctx.beginPath(); ctx.moveTo(pad.l, yy); ctx.lineTo(W-pad.r, yy); ctx.stroke();
      }
      ctx.restore();

      // draw area path (using eased progress to interpolate y towards final)
      ctx.beginPath();
      for(let i=0;i<points.length;i++){
        const p = points[i];
        const interpY = pad.t + (1 - eased * (1 - (p.y - pad.t)/plotH)) * plotH; // animates from bottom to final
        if(i===0) ctx.moveTo(p.x, interpY); else ctx.lineTo(p.x, interpY);
      }
      // close path to bottom
      ctx.lineTo(pad.l + (points.length-1)*xStep, pad.t + plotH);
      ctx.lineTo(pad.l, pad.t + plotH);
      // gradient fill
      const grad = ctx.createLinearGradient(0, pad.t, 0, pad.t+plotH);
      grad.addColorStop(0, 'rgba(76,211,173,0.36)');
      grad.addColorStop(1, 'rgba(76,211,173,0.06)');
      ctx.fillStyle = grad;
      ctx.fill();
      // stroke the curve with smooth line (draw again using quadratic curve for smoothing)
      ctx.beginPath();
      for(let i=0;i<points.length;i++){
        const p = points[i];
        const interpY = pad.t + (1 - eased * (1 - (p.y - pad.t)/plotH)) * plotH;
        if(i===0) ctx.moveTo(p.x, interpY);
        else {
          const prev = points[i-1];
          const cx = (prev.x + p.x)/2;
          const cy = ( (pad.t + (1 - eased * (1 - (prev.y - pad.t)/plotH)) * plotH) + interpY )/2;
          ctx.quadraticCurveTo(prev.x, pad.t + (1 - eased * (1 - (prev.y - pad.t)/plotH)) * plotH, cx, cy);
        }
      }
      ctx.strokeStyle = '#019267';
      ctx.lineWidth = 2.4;
      ctx.stroke();

      // draw circles and labels for each point near the top (small fade-in)
      for(let i=0;i<points.length;i++){
        const p = points[i];
        const interpY = pad.t + (1 - eased * (1 - (p.y - pad.t)/plotH)) * plotH;
        ctx.beginPath();
        ctx.fillStyle = '#ffffff';
        ctx.strokeStyle = '#019267';
        ctx.lineWidth = 2;
        ctx.arc(p.x, interpY, 5, 0, Math.PI*2);
        ctx.fill();
        ctx.stroke();

        // small value label above point
        ctx.fillStyle = '#05614b';
        ctx.font = '12px Poppins, Arial';
        ctx.textAlign = 'center';
        ctx.fillText('₹'+Number(p.v).toLocaleString(undefined,{maximumFractionDigits:0}), p.x, interpY - 10 - (1-eased)*10);
      }

      // x axis labels
      ctx.fillStyle = '#2f4f4f';
      ctx.font = '12px Poppins, Arial';
      ctx.textAlign = 'center';
      for(let i=0;i<years.length;i++){
        const x = pad.l + i*xStep;
        const label = years[i];
        ctx.fillText(label, x, pad.t + plotH + 20);
      }

      // y-axis: draw max label
      ctx.textAlign = 'right';
      ctx.fillStyle = '#2f4f4f';
      ctx.font = '12px Poppins, Arial';
      ctx.fillText('₹'+Number(maxV).toLocaleString(undefined,{maximumFractionDigits:0}), W - 8, pad.t + 10);

      if(t < 1) requestAnimationFrame(frame);
    }

    requestAnimationFrame(frame);
  }

  // Calculation logic
  function calculateAndRender(){
    let monthly = Number(monthlyEl.value) || 0;
    let interest = (Number(interestEl.value) || 0)/100;
    let stepUp = (Number(stepupEl.value) || 0)/100;
    let years = Math.max(1, Number(yearsEl.value) || 1);
    let startMonth = Number(startMonthEl.value) - 1;

    const monthlyRate = interest/12;
    let rows = [];
    let totalInvested = 0, corpus = 0;
    let currMonthly = monthly;

    for(let y=1;y<=years;y++){
      let investedThisYear = 0;
      let yearStartMonth = (startMonth + (y-1)*12) % 12;
      let startLabel = monthNames[yearStartMonth];
      let endLabel = monthNames[(yearStartMonth+11)%12];

      for(let m=0;m<12;m++){
        corpus = corpus*(1+monthlyRate) + currMonthly;
        investedThisYear += currMonthly;
        totalInvested += currMonthly;
      }
      rows.push({year:y, period: startLabel+'-'+endLabel, monthly: Math.round(currMonthly), invested: Math.round(investedThisYear), totalInvested: Math.round(totalInvested), corpus: Math.round(corpus)});
      currMonthly = currMonthly * (1+stepUp);
    }

    lastRows = rows;

    // Summary
    resultsEl.style.display='block';
    resultsEl.innerHTML = `<div>Total Invested: ₹${fmt(rows[rows.length-1].totalInvested)}</div><div style="margin-top:6px">Maturity Value: <strong>₹${fmt(rows[rows.length-1].corpus)}</strong></div>`;

    // Table
    let html = '<table><thead><tr><th>Year</th><th>Period</th><th>Monthly SIP (₹)</th><th>Annual Invested (₹)</th><th>Total Invested (₹)</th><th>Corpus (₹)</th></tr></thead><tbody>';
    rows.forEach(r=>{
      html += `<tr><td>${r.year}</td><td>${r.period}</td><td>₹${fmt(r.monthly)}</td><td>₹${fmt(r.invested)}</td><td>₹${fmt(r.totalInvested)}</td><td>₹${fmt(r.corpus)}</td></tr>`;
    });
    html += '</tbody></table>';
    tableWrap.innerHTML = html;

    // Chart: use yearly labels and corpus values
    const labels = rows.map(r=>'Y'+r.year);
    const values = rows.map(r=>r.corpus);
    renderAreaChart(labels, values);
  }

  // CSV download
  function downloadCSV(){
    if(!lastRows.length){ alert('Please calculate first!'); return; }
    let csv = 'Year,Period,Monthly SIP,Annual Invested,Total Invested,Corpus\n';
    lastRows.forEach(r=>{
      csv += `${r.year},${r.period},${r.monthly},${r.invested},${r.totalInvested},${r.corpus}\n`;
    });
    const blob = new Blob([csv], {type:'text/csv'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'sip_calculator.csv';
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  }

  // Event bindings
  calcBtn.addEventListener('click', calculateAndRender);
  csvBtn.addEventListener('click', downloadCSV);

  // initial draw placeholder
  drawPlaceholder();
</script>
</body>
</html>
